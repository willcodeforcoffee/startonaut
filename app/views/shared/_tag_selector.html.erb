<div data-controller="tags"
     data-tags-url-value="<%= search_tags_path %>"
     data-tags-selected-tags-value="<%= (form.object.tags.pluck(:name) rescue []).to_json %>"
     data-action="click@window->tags#clickOutside"
  class="relative">
  <!-- Selected Tags Display -->
  <div data-tags-target="tagContainer" class="mb-2"></div>
  <!-- Input Field -->
  <div class="relative">
    <%= form.text_field :tag_search,
        placeholder: "Type to search tags...",
        autocomplete: "off",
        data: {
          tags_target: "input",
          action: "input->tags#search keydown->tags#handleKeydown"
        },
        class: ["block shadow-sm rounded-md border px-3 py-2 w-full", {"border-gray-400 focus:outline-blue-600": !form.object.errors[:tags].any?, "border-red-400 focus:outline-red-600": form.object.errors[:tags].any?}] %>
    <!-- Hidden input for form submission -->
    <%= form.hidden_field :tag_list, data: { tags_target: "hiddenInput" } %>
    <!-- Dropdown -->
    <div data-tags-target="dropdown"
         class="absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg hidden max-h-60 overflow-y-auto">
      <!-- Dynamic content will be inserted here -->
    </div>
  </div>
  <p class="text-sm text-gray-500 mt-1">Type to search existing tags or create new ones. Press Enter to add.</p>
</div>
